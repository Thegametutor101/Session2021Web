<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Les Évènements</title>
    <link rel="icon" href="../../Ressources/assets/img/logo-departement-informatique.svg">
    <link rel="stylesheet" type="text/css"
          href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.5.2/css/bootstrap.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.23/css/dataTables.bootstrap4.min.css">
    <script src="https://kit.fontawesome.com/86aa9796b2.js" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="../Ressources/css/Style-Les_Evenements.css">
    <link rel="stylesheet" href="../Ressources/css/Style-Partie-Administrative.css">
</head>

<body>
<!-- Le slide menu à gauche -->
<div id="mySidenav" class="sidenav">
    <a href="javascript:void(0)" class="closebtn" onclick="closeNav()">&times;</a>
    <a href="Accueil-Administratif.html">Accueil Administratif</a>
    <a href="Les-Utilisateurs.html">Utilisateurs</a>
    <a href="Les-Actualites.html">Actualités</a>
    <a href="Les-Evenements.html" id="Page-Selectionne">Évènements</a>
    <a href="Les-Liens.html">Liens</a>
    <a href="Le-Contact.html">Contact</a>
    <a href="Les-Temoignages.html">Témoignages</a>
    <a href="Presentation-Programme.html">Présentation du Programme</a>
    <a href="Video-Accueil.html">Vidéo d'Accueil</a>
    <a href="Logs-Site-Web.html">Logs du Site Web</a>
    <a href="Deconnexion.html" target="_blank" onclick="closeWin()" id="deconnexion">Déconnexion</a>
</div>

<!-- Le bouton pour accéder au menu-->
<img src="../Ressources/images/Logo_Slide_Menu.png" onclick="openNav()">

<!-- La div principale qui contient toutes les informations du site web. L'id "main" doit obligatoirement être présent -->
<div id="main" style="background-color: white">
    <table id="table" class="table table-striped table-bordered" style="width:100%">
        <thead>
        <tr>
            <th>Nom</th>
            <th>Description</th>
            <th>Location</th>
            <th>Début</th>
            <th>Fin</th>
            <th>Capacité maximale</th>
            <th></th>
        </tr>
        </thead>

    </table>
</div>
</body>


<script>
    /* Fait fermer la fenêtre */
    function closeWin() {
        window.top.close();
    }

    /* Permet d'ouvrir le slide menu de gauche */
    function openNav() {
        document.getElementById("mySidenav").style.width = "400px";
        document.getElementById("main").style.marginLeft = "400px";
    }

    /* Permet de fermer le slide menu de gauche */
    function closeNav() {
        document.getElementById("mySidenav").style.width = "0";
        document.getElementById("main").style.marginLeft = "0";
    }
</script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script type="text/javascript" language="javascript"
        src="https://cdn.datatables.net/1.10.23/js/jquery.dataTables.min.js"></script>
<script type="text/javascript" language="javascript"
        src="https://cdn.datatables.net/1.10.23/js/dataTables.bootstrap4.min.js"></script>
<script type="text/javascript" charset="utf8"
        src="https://cdn.datatables.net/plug-ins/1.10.22/i18n/French.json"></script>
<script type="text/javascript" charset="utf8"
        src="https://cdn.datatables.net/buttons/1.6.5/js/dataTables.buttons.min.js"></script>
<script>
    $(document).ready(function () {
        function getMonthName(date) {
            const monthNames = ["Janv", "Fevr", "Mars", "Avr", "Mai", "Juin",
                "Juill", "Août", "Sept", "Oct", "Nov", "Dec"
            ];
            return monthNames[date.getMonth()]
        }

        $.ajax({
            url: "../Ressources/php/bd.php",
            type: "POST",
            dataType: "json",
            data: {
                "requete": "selectEvents",
            },
            success: function (reponse) {
                reponse.forEach(function (item) {
                    let ds = new Date(item['dateStart'])
                    let de = new Date(item['dateEnd'])
                    let content = "<tr>";
                    content += "<td>" + item['name'] + "</td>";
                    content += "<td>" + item['description'] + "</td>";
                    content += "<td>" + item['location'] +"</td>";
                    content += "<td>" + ds.getFullYear() + "-" + getMonthName(ds) + "-" + ds.getDate() + "</td>";
                    content += "<td>" + de.getFullYear() + "-" + getMonthName(de) + "-" + de.getDate() + "</td>";
                    content += "<td>" + item['maxCapacity'] + "</td>";
                    content += "<td>";
                    content += "<div style='display: flex; justify-content: space-evenly'>"
                    content += "<a href='#' class='mod btn btn-primary btn-circle-lg'><i class='fas fa-pencil-alt'></i></a>";
                    content += "<form id='" + item['id'] + "' method='post' action='#'>"
                    content += " <button type='submit' class='sup btn btn-primary btn-circle-lg align-content-end'><i class='fas fa-trash'></i></button>"
                    content += "</form>"
                    content += " </div>";
                    content += "</td>";
                    content += "</tr>";
                    document.getElementById('table').innerHTML += content;

                })
                table();
            },
            error: function (message, e) {

            }

        });

        function table() {
            $('#table').DataTable({
                "columnDefs": [{
                    "targets": 6,
                    "orderable": false,
                },],
                "language": {
                    "emptyTable": "Aucune donnée disponible dans le tableau",
                    "lengthMenu": "Afficher _MENU_ éléments",
                    "loadingRecords": "Chargement...",
                    "processing": "Traitement...",
                    "zeroRecords": "Aucun élément correspondant trouvé",
                    "paginate": {
                        "first": "Premier",
                        "last": "Dernier",
                        "next": "Suivant",
                        "previous": "Précédent"
                    },
                    "aria": {
                        "sortAscending": ": activer pour trier la colonne par ordre croissant",
                        "sortDescending": ": activer pour trier la colonne par ordre décroissant"
                    },
                    "select": {
                        "rows": {
                            "_": "%d lignes sélectionnées",
                            "0": "Aucune ligne sélectionnée",
                            "1": "1 ligne sélectionnée"
                        },
                        "1": "1 ligne selectionnée",
                        "_": "%d lignes selectionnées",
                        "cells": {
                            "1": "1 cellule sélectionnée",
                            "_": "%d cellules sélectionnées"
                        },
                        "columns": {
                            "1": "1 colonne sélectionnée",
                            "_": "%d colonnes sélectionnées"
                        }
                    },
                    "autoFill": {
                        "cancel": "Annuler",
                        "fill": "Remplir toutes les cellules avec <i>%d<\/i>",
                        "fillHorizontal": "Remplir les cellules horizontalement",
                        "fillVertical": "Remplir les cellules verticalement",
                        "info": "Exemple de remplissage automatique"
                    },
                    "searchBuilder": {
                        "conditions": {
                            "date": {
                                "after": "Après le",
                                "before": "Avant le",
                                "between": "Entre",
                                "empty": "Vide",
                                "equals": "Egal à",
                                "not": "Différent de",
                                "notBetween": "Pas entre",
                                "notEmpty": "Non vide"
                            },
                            "moment": {
                                "after": "Après le",
                                "before": "Avant le",
                                "between": "Entre",
                                "empty": "Vide",
                                "equals": "Egal à",
                                "not": "Différent de",
                                "notBetween": "Pas entre",
                                "notEmpty": "Non vide"
                            },
                            "number": {
                                "between": "Entre",
                                "empty": "Vide",
                                "equals": "Egal à",
                                "gt": "Supérieur à",
                                "gte": "Supérieur ou égal à",
                                "lt": "Inférieur à",
                                "lte": "Inférieur ou égal à",
                                "not": "Différent de",
                                "notBetween": "Pas entre",
                                "notEmpty": "Non vide"
                            },
                            "string": {
                                "contains": "Contient",
                                "empty": "Vide",
                                "endsWith": "Se termine par",
                                "equals": "Egal à",
                                "not": "Différent de",
                                "notEmpty": "Non vide",
                                "startsWith": "Commence par"
                            },
                            "array": {
                                "equals": "Egal à",
                                "empty": "Vide",
                                "contains": "Contient",
                                "not": "Différent de",
                                "notEmpty": "Non vide",
                                "without": "Sans"
                            }
                        },
                        "add": "Ajouter une condition",
                        "button": {
                            "0": "Recherche avancée",
                            "_": "Recherche avancée (%d)"
                        },
                        "clearAll": "Effacer tout",
                        "condition": "Condition",
                        "data": "Donnée",
                        "deleteTitle": "Supprimer la règle de filtrage",
                        "logicAnd": "Et",
                        "logicOr": "Ou",
                        "title": {
                            "0": "Recherche avancée",
                            "_": "Recherche avancée (%d)"
                        },
                        "value": "Valeur"
                    },
                    "searchPanes": {
                        "clearMessage": "Effacer tout",
                        "count": "{total}",
                        "title": "Filtres actifs - %d",
                        "collapse": {
                            "0": "Volet de recherche",
                            "_": "Volet de recherche (%d)"
                        },
                        "countFiltered": "{shown} ({total})",
                        "emptyPanes": "Pas de volet de recherche",
                        "loadMessage": "Chargement du volet de recherche..."
                    },
                    "buttons": {
                        "copyKeys": "Appuyer sur ctrl ou u2318 + C pour copier les données du tableau dans votre presse-papier.",
                        "collection": "Collection",
                        "colvis": "Visibilité colonnes",
                        "colvisRestore": "Rétablir visibilité",
                        "copy": "Copier",
                        "copySuccess": {
                            "1": "1 ligne copiée dans le presse-papier",
                            "_": "%ds lignes copiées dans le presse-papier"
                        },
                        "copyTitle": "Copier dans le presse-papier",
                        "csv": "CSV",
                        "excel": "Excel",
                        "pageLength": {
                            "-1": "Afficher toutes les lignes",
                            "1": "Afficher 1 ligne",
                            "_": "Afficher %d lignes"
                        },
                        "pdf": "PDF",
                        "print": "Imprimer"
                    },
                    "decimal": ",",
                    "info": "Affichage de _START_ à _END_ sur _TOTAL_ éléments",
                    "infoEmpty": "Affichage de 0 à 0 sur 0 éléments",
                    "infoFiltered": "(filtrés de _MAX_ éléments au total)",
                    "infoThousands": ".",
                    "search": "Rechercher:",
                    "searchPlaceholder": "Rechercher...",
                    "thousands": "."
                }
            });
        }

    });
</script>
</html>